# Ultimate Dice Roller

Play a dice rolling game with Alexa to see if the total sum of all your rolls can beat the top scores!

---

## Project Requirements

- [x] The user can roll a virtual dice.
- [x] If the user rolls 2-6, the roll is added to their score.
- [x] If the user rolls a 1, the user's score is reset to zero.
- [x] After each roll, the user is asked if they want to continue or end the game.
- [x] The user is able to start a new game or listen to the top 10 high scores.
- [x] The user's total score is persisted throughout the game session.
- [x] The user has the option to upload their high score to DynamoDB for permanent persistence

## Play

- To open the game say: "Alexa, `open Ultimate Dice Roller.`"
- To play the game, when Alexa asks if you want to roll the dice say: `Yes.`
- To upload your high score after a game ends say: `Add {firstName}` or `Add me to the leaderboard` or `Add me`.
- To view the top scores say: `Get top scores` or `Show me the top scores` or `Show top scores`.
- To end the game, say: `Bye!`

[![Persistence Example](https://i.gyazo.com/98c487227c894de1a52eafea40331ce6.png)](https://gyazo.com/98c487227c894de1a52eafea40331ce6)

## File Structure

| Syntax            | Description                                                                      | File                                                                                                              |
| ----------------- | -------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------- |
| Handlers          | Methods that specify Alexa commands                                              | [src/handler.js](https://github.com/garrettmmoore/alexa-dice-game/blob/master/src/handler.js)                     |
| Interaction Model | Define the Voice interface by mapping users' spoken input to the intent handlers | [models/en-US.json](https://github.com/garrettmmoore/alexa-dice-game/blob/master/models/en-US.json)               |
| DynamoDB Helper   | Method to handle all calls to DynamoDB                                           | [src/helpers/dbUtility.js](https://github.com/garrettmmoore/alexa-dice-game/blob/master/src/helpers/dbUtility.js) |
| Skills Manifest   | Skills for Alexa                                                                 | [skill.json](https://github.com/garrettmmoore/alexa-dice-game/blob/master/skill.json)                             |

## DynamoDB Approach

---

### DB Structure

- Table Name: `GameScore`
- Primary Partition Key: `UserId` (String). This unique ID is generated by Alexa. [Read more here.](https://developer.amazon.com/en-US/docs/alexa/custom-skills/request-and-response-json-reference.html)
- Primary Sort Key: `GameTitle` (String).
- Attribute: `TopScore` (Number) Attribute.
- Attribute: `FirstName` (String) Attribute.

- Global Secondary Index: `GameTitleIndex`
- Secondary Partition Key: `GameTitle`
- Secondary Sort Key: `TopScore`

[![Dynamo Sort Example](https://i.gyazo.com/ec3331a4e2f8a734cc7bef8b67a31dd1.png)](https://gyazo.com/ec3331a4e2f8a734cc7bef8b67a31dd1)

- The global secondary index allows quering the GameTitle and sorting by the TopScore.
- Setting the `ScanIndexForward` query paramater to false returns the results in descending order.
- From here, the `Limit` property is applied to the query to obtain only the first 10 results.
- Although we only use with one game title in this project, this approach will scale when querying multiple game titles as well.

## Run Locally

Install Node.js dependencies.

```bash
npm install
```

Deploy project as a Lambda function to AWS

```bash
npm run deploy
```

## Required

- [Create an Alexa Skills Developer account](https://developer.amazon.com/en-US/alexa/alexa-skills-kit)
- [Create an AWS account](https://aws.amazon.com)
- [Install and configure the AWS-CLI](https://aws.amazon.com/cli/)
- Add the Lambda Arn to the [build script](https://github.com/garrettmmoore/alexa-dice-game/blob/39e1c5affe553696ac860c616f112a678e89b577/package.json#L7) in your `package.json` in order to deploy
- Create a [DynamoDB table](https://console.aws.amazon.com/dynamodb) to store and persist user game scores
